CREATE TABLE t_preparations (
	id INT PRIMARY KEY AUTO_INCREMENT,
	preparation_code VARCHAR(255) NOT NULL,
	preparation_type ENUM('INTERNAL', 'EXTERNAL'),
	status ENUM('DRAFT', 'ASSIGNED', 'PICKING', 'WAITING CHECK', 'ON CHECK', 'WAITING APPROVAL', 'APPROVED', 'COMPLETED', 'CANCELLED') DEFAULT 'DRAFT',
	destination_id INT NOT NULL,
	created_id INT NOT NULL,
	worker_id INT NOT NULL,
	approved_id INT NOT NULL,
	temporary_location_id INT,
	total_box INT,
	created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
	updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
	notes VARCHAR(255),
	FOREIGN KEY(temporary_location_id) REFERENCES t_locations(id),
	FOREIGN KEY(destination_id) REFERENCES t_locations(id),
	FOREIGN KEY(created_id) REFERENCES t_users(id),
	FOREIGN KEY(worker_id) REFERENCES t_users(id),
	FOREIGN KEY(approved_id) REFERENCES t_users(id)
);

CREATE TABLE t_preparation_logs(
	id int PRIMARY KEY AUTO_INCREMENT,
	preparation_id INT NOT NULL,
	from_status VARCHAR(255),
	to_status VARCHAR(255),
	updated_by INT NOT NULL,
	updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
	notes VARCHAR(255),
	FOREIGN KEY(preparation_id) REFERENCES t_preparations(id),
	FOREIGN KEY(updated_by) REFERENCES t_users(id)
);